<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Marketplace Steal a Brainrot</title>
<style>
body { font-family: Arial, sans-serif; background:#0f0f1d; color:#fff; margin:0; padding:0; }
header { display:flex; justify-content:space-between; align-items:center; padding:15px 20px; background:#1f4068; box-shadow:0 2px 5px rgba(0,0,0,0.5); }
header h1 { margin:0; font-size:22px; color:#f5f5f5; }
#vendeButton { padding:10px 20px; border:none; border-radius:12px; background:linear-gradient(90deg,#6a2c70,#b83b5e); color:white; font-weight:bold; cursor:pointer; font-size:16px; }
#popupNotification { display:flex; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); align-items:center; justify-content:center; z-index:100; }
#popupNotification div { background:#162447; padding:30px; border-radius:15px; text-align:center; max-width:320px; width:90%; }
#popupNotification button { padding:12px 25px; margin:10px; border:none; border-radius:12px; background:#e43f5a; color:white; font-weight:bold; cursor:pointer; font-size:16px; }
#popupForm { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:#162447; padding:25px; border-radius:15px; box-shadow:0 0 15px rgba(0,0,0,0.7); z-index:101; width:90%; max-width:400px; }
#popupForm input, #popupForm select { width:100%; margin:8px 0; padding:10px; border-radius:8px; border:none; font-size:16px; }
#popupForm button { padding:12px; width:100%; border:none; border-radius:12px; background:#e43f5a; color:white; font-weight:bold; cursor:pointer; margin-top:10px; font-size:16px; }
#marketplace { display:flex; flex-wrap:wrap; padding:20px; gap:15px; justify-content:center; }
.itemCard { background:#1f4068; border-radius:12px; padding:15px; width:180px; text-align:center; box-shadow:0 0 10px rgba(0,0,0,0.5); position:relative; }
.itemCard img { width:100%; height:140px; object-fit:cover; border-radius:8px; }
.itemCard button { margin-top:10px; padding:8px 10px; border:none; border-radius:8px; background:#6a2c70; color:white; cursor:pointer; font-size:14px; }
.itemCard .supprimerBtn { background:#e43f5a; position:absolute; top:5px; right:5px; padding:4px 8px; font-size:12px; }
.channelHeader { display:flex; justify-content:center; align-items:center; background:#162447; padding:15px; border-radius:15px; box-shadow:0 0 10px rgba(0,0,0,0.5); max-width:600px; margin:15px auto; font-size:22px; font-weight:bold; color:#f5f5f5; }
</style>
</head>
<body>

<div class="channelHeader">LaTeamBlox</div>

<div id="popupNotification">
  <div>
    <h2>Autoriser les notifications ?</h2>
    <button id="notifOui">Oui</button>
    <button id="notifNon">Non</button>
  </div>
</div>

<header>
  <h1>Marketplace Brainrot</h1>
  <button id="vendeButton">VENDRE</button>
</header>

<div id="popupForm">
  <h2>Ajouter votre bÃªte</h2>
  <input type="text" id="nomBete" placeholder="Nom de la bÃªte" required>
  <input type="text" id="descriptionBete" placeholder="Description" required>
  <select id="mutationBete">
    <option value="Normal">Normal</option>
    <option value="Gold">Gold</option>
    <option value="Diamant">Diamant</option>
    <option value="Rainbow">Rainbow</option>
    <option value="Candy">Candy</option>
    <option value="Bloodroot">Bloodroot</option>
  </select>
  <input type="file" id="imageBete" accept="image/*" required>
  <input type="text" id="utilisateurRoblox" placeholder="Nom utilisateur Roblox" required>
  <input type="number" id="prixRobux" placeholder="Prix en Robux" required>
  <button id="enregistrerBete">Enregistrer</button>
</div>

<div id="marketplace"></div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // ðŸ”¹ Supprimer tout ce qui avait Ã©tÃ© sauvegardÃ© avant
    localStorage.removeItem('itemsSauvegardes');

    let notificationsAutorisees = false;
    const popupNotification = document.getElementById('popupNotification');
    const notifOui = document.getElementById('notifOui');
    const notifNon = document.getElementById('notifNon');

    popupNotification.style.display = 'flex';

    notifOui.addEventListener('click', () => {
        notificationsAutorisees = true;
        window.notificationsAutorisees = true;
        popupNotification.style.display='none';
        alert('Notifications activÃ©es !');
    });

    notifNon.addEventListener('click', () => {
        notificationsAutorisees = false;
        window.notificationsAutorisees = false;
        popupNotification.style.display='none';
        alert('Vous devez activer les notifications pour utiliser la marketplace.');
    });

    // ðŸ”¹ Initialisation marketplace
    let itemsSauvegardes = JSON.parse(localStorage.getItem('itemsSauvegardes') || '[]');

    function afficherItem(item){
        const card = document.createElement('div');
        card.className = 'itemCard';
        card.innerHTML = `
            <img src="${item.imageURL}" alt="BÃªte">
            <h3>${item.nom}</h3>
            <p>${item.description}</p>
            <p>Mutation: ${item.mutation}</p>
            <p>Utilisateur: ${item.utilisateur}</p>
            <p>Prix: ${item.prix} Robux</p>
            <button onclick="acheterBete('${item.nom}','${item.utilisateur}',${item.prix})">Acheter</button>
        `;

        // Ajouter le bouton supprimer uniquement pour le crÃ©ateur actuel
        if(item.utilisateur === document.getElementById('utilisateurRoblox').value.trim() || item.utilisateur === ""){
            const btnSupprimer = document.createElement('button');
            btnSupprimer.textContent = 'Supprimer';
            btnSupprimer.className = 'supprimerBtn';
            btnSupprimer.onclick = () => {
                itemsSauvegardes = itemsSauvegardes.filter(i => i !== item);
                localStorage.setItem('itemsSauvegardes', JSON.stringify(itemsSauvegardes));
                card.remove();
            };
            card.appendChild(btnSupprimer);
        }

        document.getElementById('marketplace').appendChild(card);
    }

    function chargerMarketplace(){
        document.getElementById('marketplace').innerHTML = '';
        itemsSauvegardes.forEach(afficherItem);
    }

    function ajouterItem(item){
        itemsSauvegardes.push(item);
        localStorage.setItem('itemsSauvegardes', JSON.stringify(itemsSauvegardes));
        afficherItem(item);
    }

    // Charger la marketplace au dÃ©marrage
    chargerMarketplace();

    // VENDRE
    const popupForm = document.getElementById('popupForm');
    document.getElementById('vendeButton').onclick = () => { popupForm.style.display='block'; }

    const enregistrerBete = document.getElementById('enregistrerBete');
    enregistrerBete.addEventListener('click', () => {
        const nom = document.getElementById('nomBete').value.trim();
        const description = document.getElementById('descriptionBete').value.trim();
        const mutation = document.getElementById('mutationBete').value;
        const utilisateur = document.getElementById('utilisateurRoblox').value.trim();
        const prix = document.getElementById('prixRobux').value.trim();
        const imageInput = document.getElementById('imageBete');

        if(!nom || !description || !mutation || !utilisateur || !prix){
            alert('Remplis tous les champs !');
            return;
        }
        if(!imageInput.files || !imageInput.files[0]){
            alert('Choisis une image !');
            return;
        }

        const imageURL = URL.createObjectURL(imageInput.files[0]);

        const nouvelItem = { nom, description, mutation, utilisateur, prix: parseInt(prix), imageURL };
        ajouterItem(nouvelItem);

        document.getElementById('nomBete').value = '';
        document.getElementById('descriptionBete').value = '';
        document.getElementById('utilisateurRoblox').value = '';
        document.getElementById('prixRobux').value = '';
        document.getElementById('imageBete').value = '';
        popupForm.style.display = 'none';
    });

    window.acheterBete = function(nom, vendeur, prix){
        if(!window.notificationsAutorisees){ alert("Activez les notifications avant d'acheter !"); return; }
        const code = prompt(`Entrez le code Roblox pour acheter ${nom} de ${vendeur} pour ${prix} Robux :`);
        if(code){ alert(`Achat simulÃ© ! VÃ©rifiez le code Roblox avant la transaction.`); }
    }

});
</script>
</body>
</html>


